<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Numeric/NumType/TF.lhs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
Numeric.NumType.TF -- Type-level (low cardinality) integers
Bjorn Buckwalter, bjorn.buckwalter@gmail.com
License: BSD3


= Preliminaries =

This module requires GHC 7.0 or later.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>{-# LANGUAGE UndecidableInstances
<a name="line-2"></a>&gt;            , TypeFamilies
<a name="line-3"></a>&gt;            , EmptyDataDecls
<a name="line-4"></a>&gt;            , FlexibleInstances
<a name="line-5"></a>&gt;            , ScopedTypeVariables
<a name="line-6"></a>&gt;            , DeriveDataTypeable
<a name="line-7"></a>&gt; #-}</span>
</pre>

= Summary =

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>{- |
<a name="line-2"></a>&gt;    Copyright  : Copyright (C) 2006-2012 Bjorn Buckwalter
<a name="line-3"></a>&gt;    License    : BSD3
<a name="line-4"></a>&gt;
<a name="line-5"></a>&gt;    Maintainer : bjorn.buckwalter@gmail.com
<a name="line-6"></a>&gt;    Stability  : Stable
<a name="line-7"></a>&gt;    Portability: GHC only?
<a name="line-8"></a>&gt;
<a name="line-9"></a>&gt; This Module provides unary type-level representations, hereafter
<a name="line-10"></a>&gt; referred to as 'NumType's, of the (positive and negative) integers
<a name="line-11"></a>&gt; and basic operations (addition, subtraction, multiplication, division)
<a name="line-12"></a>&gt; on these. While functions are provided for the operations 'NumType's
<a name="line-13"></a>&gt; exist solely at the type level and their only value is 'undefined'.
<a name="line-14"></a>&gt; 
<a name="line-15"></a>&gt; There are similarities with the HNats of the HList library,
<a name="line-16"></a>&gt; which was indeed a source of inspiration. Occasionally references
<a name="line-17"></a>&gt; are made to the HNats. The main addition in this module is negative
<a name="line-18"></a>&gt; numbers.
<a name="line-19"></a>&gt; 
<a name="line-20"></a>&gt; The practical size of the 'NumType's is limited by the type checker
<a name="line-21"></a>&gt; stack. If the 'NumType's grow too large (which can happen quickly
<a name="line-22"></a>&gt; with multiplication) an error message similar to the following will
<a name="line-23"></a>&gt; be emitted:
<a name="line-24"></a>&gt; 
<a name="line-25"></a>&gt; @
<a name="line-26"></a>&gt; Context reduction stack overflow; size = 20
<a name="line-27"></a>&gt; Use -fcontext-stack=N to increase stack size to N
<a name="line-28"></a>&gt; @
<a name="line-29"></a>&gt;
<a name="line-30"></a>&gt; This situation could concievably be mitigated significantly by using
<a name="line-31"></a>&gt; e.g. a binary representation of integers rather than Peano numbers.
<a name="line-32"></a>&gt; 
<a name="line-33"></a>&gt; Please refer to the literate Haskell code for a narrative of 
<a name="line-34"></a>&gt; the implementation.
<a name="line-35"></a>&gt;
<a name="line-36"></a>&gt; -}</span>
</pre>
<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>module</span> <span class='hs-conid'>Numeric</span><span class='hs-varop'>.</span><span class='hs-conid'>NumType</span><span class='hs-varop'>.</span><span class='hs-conid'>TF</span> <span class='hs-layout'>(</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span>   <span class='hs-comment'>-- * Type level integers</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span>     <span class='hs-conid'>NumType</span>
<a name="line-4"></a><span class='hs-varop'>&gt;</span>   <span class='hs-comment'>-- * Data types</span>
<a name="line-5"></a><span class='hs-varop'>&gt;</span>   <span class='hs-comment'>-- | These are exported to avoid lengthy qualified types in complier</span>
<a name="line-6"></a><span class='hs-varop'>&gt;</span>   <span class='hs-comment'>-- error messages.</span>
<a name="line-7"></a><span class='hs-varop'>&gt;</span>   <span class='hs-layout'>,</span> <span class='hs-conid'>Z</span><span class='hs-layout'>,</span> <span class='hs-conid'>S</span><span class='hs-layout'>,</span> <span class='hs-conid'>N</span>
<a name="line-8"></a><span class='hs-varop'>&gt;</span>   <span class='hs-comment'>-- * Type level arithmetics</span>
<a name="line-9"></a><span class='hs-varop'>&gt;</span>   <span class='hs-layout'>,</span> <span class='hs-conid'>Pred</span><span class='hs-layout'>,</span> <span class='hs-conid'>Succ</span><span class='hs-layout'>,</span> <span class='hs-conid'>Negate</span><span class='hs-layout'>,</span> <span class='hs-conid'>Add</span><span class='hs-layout'>,</span> <span class='hs-conid'>Sub</span><span class='hs-layout'>,</span> <span class='hs-conid'>Div</span><span class='hs-layout'>,</span> <span class='hs-conid'>Mul</span>
<a name="line-10"></a><span class='hs-varop'>&gt;</span>   <span class='hs-comment'>-- * Type synonyms for convenience</span>
<a name="line-11"></a><span class='hs-varop'>&gt;</span>   <span class='hs-layout'>,</span> <span class='hs-conid'>Zero</span><span class='hs-layout'>,</span> <span class='hs-conid'>Pos1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Pos2</span><span class='hs-layout'>,</span> <span class='hs-conid'>Pos3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Pos4</span><span class='hs-layout'>,</span> <span class='hs-conid'>Pos5</span><span class='hs-layout'>,</span> <span class='hs-conid'>Neg1</span><span class='hs-layout'>,</span> <span class='hs-conid'>Neg2</span><span class='hs-layout'>,</span> <span class='hs-conid'>Neg3</span><span class='hs-layout'>,</span> <span class='hs-conid'>Neg4</span><span class='hs-layout'>,</span> <span class='hs-conid'>Neg5</span>
<a name="line-12"></a><span class='hs-varop'>&gt;</span>   <span class='hs-comment'>-- * Value level functions</span>
<a name="line-13"></a><span class='hs-varop'>&gt;</span>   <span class='hs-comment'>-- $functions</span>
<a name="line-14"></a><span class='hs-varop'>&gt;</span>   <span class='hs-layout'>,</span> <span class='hs-varid'>toNum</span><span class='hs-layout'>,</span> <span class='hs-varid'>incr</span><span class='hs-layout'>,</span> <span class='hs-varid'>decr</span><span class='hs-layout'>,</span> <span class='hs-varid'>negate</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>+</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>*</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>/</span><span class='hs-layout'>)</span>
<a name="line-15"></a><span class='hs-varop'>&gt;</span>   <span class='hs-comment'>-- * Values for convenience</span>
<a name="line-16"></a><span class='hs-varop'>&gt;</span>   <span class='hs-comment'>-- | For use with the value level functions.</span>
<a name="line-17"></a><span class='hs-varop'>&gt;</span>   <span class='hs-layout'>,</span> <span class='hs-varid'>zero</span><span class='hs-layout'>,</span> <span class='hs-varid'>pos1</span><span class='hs-layout'>,</span> <span class='hs-varid'>pos2</span><span class='hs-layout'>,</span> <span class='hs-varid'>pos3</span><span class='hs-layout'>,</span> <span class='hs-varid'>pos4</span><span class='hs-layout'>,</span> <span class='hs-varid'>pos5</span><span class='hs-layout'>,</span> <span class='hs-varid'>neg1</span><span class='hs-layout'>,</span> <span class='hs-varid'>neg2</span><span class='hs-layout'>,</span> <span class='hs-varid'>neg3</span><span class='hs-layout'>,</span> <span class='hs-varid'>neg4</span><span class='hs-layout'>,</span> <span class='hs-varid'>neg5</span>
<a name="line-18"></a><span class='hs-varop'>&gt;</span>   <span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
</pre>
<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varop'>*</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>/</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>+</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>negate</span><span class='hs-layout'>)</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>import</span> <span class='hs-keyword'>qualified</span> <span class='hs-conid'>Prelude</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varop'>+</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>negate</span><span class='hs-layout'>)</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>Typeable</span> <span class='hs-layout'>(</span><span class='hs-conid'>Typeable</span><span class='hs-layout'>)</span>
</pre>
Use the same fixity for operators as the Prelude.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>infixl</span> <span class='hs-num'>7</span>  <span class='hs-varop'>*</span><span class='hs-layout'>,</span> <span class='hs-varop'>/</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>infixl</span> <span class='hs-num'>6</span>  <span class='hs-varop'>+</span><span class='hs-layout'>,</span> <span class='hs-comment'>-</span>
</pre>

= NumTypes =

We start by defining a class encompassing all integers with the
class function 'toNum' that converts from the type-level to a
value-level 'Num'.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>class</span> <span class='hs-conid'>NumTypeI</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>where</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span>   <span class='hs-comment'>-- | Negation.</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Negate</span> <span class='hs-varid'>n</span>
<a name="line-4"></a><span class='hs-varop'>&gt;</span>   <span class='hs-comment'>-- | Predecessor.</span>
<a name="line-5"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Pred</span> <span class='hs-varid'>n</span>
<a name="line-6"></a><span class='hs-varop'>&gt;</span>   <span class='hs-comment'>-- | Successor.</span>
<a name="line-7"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Succ</span> <span class='hs-varid'>n</span>
<a name="line-8"></a><span class='hs-varop'>&gt;</span>   <span class='hs-comment'>-- | Convert a type level integer to an instance of 'Prelude.Num'.</span>
<a name="line-9"></a><span class='hs-varop'>&gt;</span>   <span class='hs-varid'>toNum</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
</pre>

Now we use a trick from Oleg Kiselyov and Chung-chieh Shan [2]:

    -- The well-formedness condition, the kind predicate
    class Nat0 a where toInt :: a -> Int
    class Nat0 a => Nat a           -- (positive) naturals

    -- To prevent the user from adding new instances to Nat0 and especially
    -- to Nat (e.g., to prevent the user from adding the instance |Nat B0|)
    -- we do NOT export Nat0 and Nat. Rather, we export the following proxies.
    -- The proxies entail Nat and Nat0 and so can be used to add Nat and Nat0
    -- constraints in the signatures. However, all the constraints below
    -- are expressed in terms of Nat0 and Nat rather than proxies. Thus,
    -- even if the user adds new instances to proxies, it would not matter.
    -- Besides, because the following proxy instances are most general,
    -- one may not add further instances without overlapping instance extension.
    class    Nat0 n => Nat0E n
    instance Nat0 n => Nat0E n
    class    Nat n => NatE n
    instance Nat n => NatE n

We apply this trick to our NumTypeI class. In our case we will elect to
append an "I" to the internal (non-exported) classes rather than
appending an "E" to the exported classes.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Class encompassing all valid type level integers.</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>class</span>    <span class='hs-layout'>(</span><span class='hs-conid'>NumTypeI</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>NumType</span> <span class='hs-varid'>n</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>NumTypeI</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>NumType</span> <span class='hs-varid'>n</span>
</pre>
Now we Define the data types used to represent integers. We begin
with 'Zero', which we allow to be used as both a positive and a
negative number in the sense of the previously defined type classes.
'Z' corresponds to HList's 'HZero'.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Type level zero.</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>Z</span> <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Typeable</span>
</pre>
Next we define the "successor" type, here called 'S' (corresponding
to HList's 'HSucc').

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Successor type for building type level natural numbers.</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>S</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Typeable</span>
</pre>
Finally we define the "negation" type used to represent negative
numbers.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Negation type, used to represent negative numbers by negating</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- type level naturals.</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>N</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>deriving</span> <span class='hs-conid'>Typeable</span>
</pre>
The 'NumTypeI' instances restrict how 'Z', 'S', and 'N' may be combined
to assemble 'NumType's, and the type synonym declarations demonstrate
some basic arithmetic.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>NumTypeI</span> <span class='hs-conid'>Z</span> <span class='hs-keyword'>where</span>  <span class='hs-comment'>-- Zero.</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Negate</span> <span class='hs-conid'>Z</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Z</span>       <span class='hs-comment'>-- Still zero.</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Pred</span> <span class='hs-conid'>Z</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-conid'>Z</span><span class='hs-layout'>)</span>   <span class='hs-comment'>-- Negative one.</span>
<a name="line-4"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Succ</span> <span class='hs-conid'>Z</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span> <span class='hs-conid'>Z</span>       <span class='hs-comment'>-- One.</span>
<a name="line-5"></a><span class='hs-varop'>&gt;</span>   <span class='hs-varid'>toNum</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>0</span>
</pre>
<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>NumTypeI</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-conid'>Z</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>   <span class='hs-comment'>-- One.</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-conid'>Z</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-conid'>Z</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- Minus one.</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Pred</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-conid'>Z</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Z</span>          <span class='hs-comment'>-- Zero.</span>
<a name="line-4"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Succ</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-conid'>Z</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-conid'>Z</span><span class='hs-layout'>)</span>    <span class='hs-comment'>-- Two.</span>
<a name="line-5"></a><span class='hs-varop'>&gt;</span>   <span class='hs-varid'>toNum</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span>
</pre>
<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- Naturals greater than one.</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>NumTypeI</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>NumTypeI</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>  <span class='hs-comment'>-- N.</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>              <span class='hs-comment'>-- -N.</span>
<a name="line-4"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Pred</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span> <span class='hs-varid'>n</span>                        <span class='hs-comment'>-- N-1</span>
<a name="line-5"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Succ</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>                <span class='hs-comment'>-- N+1</span>
<a name="line-6"></a><span class='hs-varop'>&gt;</span>   <span class='hs-varid'>toNum</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-num'>1</span> <span class='hs-conid'>Prelude</span><span class='hs-varop'>.+</span> <span class='hs-varid'>toNum</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
</pre>
<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- Negatives (minus one and below).</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>NumTypeI</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>NumTypeI</span> <span class='hs-layout'>(</span><span class='hs-conid'>N</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>  <span class='hs-comment'>-- -N</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>N</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span> <span class='hs-varid'>n</span>                      <span class='hs-comment'>-- N</span>
<a name="line-4"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Pred</span> <span class='hs-layout'>(</span><span class='hs-conid'>N</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>                <span class='hs-comment'>-- -(N+1)</span>
<a name="line-5"></a><span class='hs-varop'>&gt;</span>   <span class='hs-keyword'>type</span> <span class='hs-conid'>Succ</span> <span class='hs-layout'>(</span><span class='hs-conid'>N</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Negate</span> <span class='hs-varid'>n</span>                   <span class='hs-comment'>-- -(N-1)</span>
<a name="line-6"></a><span class='hs-varop'>&gt;</span>        <span class='hs-comment'>-- NOTE: `N n` would be invalid for `Succ (N (S Z))`</span>
<a name="line-7"></a><span class='hs-varop'>&gt;</span>   <span class='hs-varid'>toNum</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Prelude</span><span class='hs-varop'>.</span><span class='hs-varid'>negate</span> <span class='hs-varop'>$</span> <span class='hs-varid'>toNum</span> <span class='hs-layout'>(</span><span class='hs-varid'>undefined</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span>
</pre>

= Show instances =

For convenience we create show instances for the defined NumTypes.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Show</span> <span class='hs-conid'>Z</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>show</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-str'>"NumType "</span> <span class='hs-varop'>++</span><span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <span class='hs-varid'>show</span> <span class='hs-varop'>.</span> <span class='hs-varid'>toNum</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>NumTypeI</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Show</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>show</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-str'>"NumType "</span> <span class='hs-varop'>++</span><span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <span class='hs-varid'>show</span> <span class='hs-varop'>.</span> <span class='hs-varid'>toNum</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>NumTypeI</span> <span class='hs-layout'>(</span><span class='hs-conid'>N</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Show</span> <span class='hs-layout'>(</span><span class='hs-conid'>N</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>show</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-str'>"NumType "</span> <span class='hs-varop'>++</span><span class='hs-layout'>)</span> <span class='hs-varop'>.</span> <span class='hs-varid'>show</span> <span class='hs-varop'>.</span> <span class='hs-varid'>toNum</span>
</pre>

= Addition and subtraction =

Now let us move on towards more complex arithmetic operations. We
define type families for addition and subtraction of NumTypes.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Addition (@a + b@).</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-varid'>family</span> <span class='hs-conid'>Add</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>  <span class='hs-comment'>-- a + b.</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Subtraction (@a - b@).</span>
<a name="line-4"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-varid'>family</span> <span class='hs-conid'>Sub</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>  <span class='hs-comment'>-- a - b.</span>
</pre>
Adding anything to Zero gives "anything".

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Add</span> <span class='hs-conid'>Z</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>n</span>
</pre>
When adding to a non-Zero number our strategy is to "transfer" type
constructors from the first type to the second type until the first
type is Zero.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Add</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-varid'>n'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Add</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-conid'>Succ</span> <span class='hs-varid'>n'</span><span class='hs-layout'>)</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Add</span> <span class='hs-layout'>(</span><span class='hs-conid'>N</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-varid'>n'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Add</span> <span class='hs-layout'>(</span><span class='hs-conid'>Succ</span> <span class='hs-layout'>(</span><span class='hs-conid'>N</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Pred</span> <span class='hs-varid'>n'</span><span class='hs-layout'>)</span>
</pre>
Subtraction is defined trivially with addition and negation.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Sub</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Add</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-conid'>Negate</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
</pre>

= Multiplication =

Type family for multiplication. Multiplication is limited by the
type checker stack. If the result of multiplication is too large
this error message will be emitted:

    Context reduction stack overflow; size = 20
    Use -fcontext-stack=N to increase stack size to N

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Multiplication (@a * b@).</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-varid'>family</span> <span class='hs-conid'>Mul</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>        <span class='hs-comment'>-- a * b.</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Mul</span> <span class='hs-conid'>Z</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Z</span>  <span class='hs-comment'>-- Trivially.</span>
</pre>
Multiplication is performed by recursive addition of one number
to itself. The recursion is terminated by the `Mul Z n` instance.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Mul</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-varid'>n'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Add</span> <span class='hs-varid'>n'</span> <span class='hs-layout'>(</span><span class='hs-conid'>Mul</span> <span class='hs-varid'>n</span> <span class='hs-varid'>n'</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- a*b = b+(a-1)*b</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Mul</span> <span class='hs-layout'>(</span><span class='hs-conid'>N</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-varid'>n'</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Negate</span> <span class='hs-layout'>(</span><span class='hs-conid'>Mul</span> <span class='hs-varid'>n</span> <span class='hs-varid'>n'</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- (-a)*b = -(a*b)</span>
</pre>

= Division =

Division is more complicated than multiplication. We start by
defining division only for positive (natural) numbers. This is
necessary to ensure bad division terminates with a proper error
instead of overflowing the context stack (more confusing).

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-varid'>family</span> <span class='hs-conid'>DivP</span> <span class='hs-varid'>n</span> <span class='hs-varid'>m</span>            <span class='hs-comment'>-- n / m.</span>
</pre>
The instances for division is based on the identities:

    0 / y = 0,               for y >= 1.
    x / y = (x - y) / y + 1, for x >= y >= 1.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>DivP</span> <span class='hs-conid'>Z</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Z</span>  <span class='hs-comment'>-- Trivially.</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>DivP</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span> <span class='hs-layout'>(</span><span class='hs-conid'>DivP</span> <span class='hs-layout'>(</span><span class='hs-conid'>Sub</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>  <span class='hs-comment'>-- Oh my!</span>
</pre>
Now we can generalize division to negative numbers too, building on
top of 'DivP'. A trivial but tedious exercise.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Division (@a / b@).</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-varid'>family</span> <span class='hs-conid'>Div</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>            <span class='hs-comment'>-- a / b.</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Div</span> <span class='hs-conid'>Z</span> <span class='hs-layout'>(</span><span class='hs-conid'>N</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Z</span>  <span class='hs-comment'>-- Mustn't allow “Div Z Z”!</span>
<a name="line-4"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Div</span> <span class='hs-conid'>Z</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Z</span>
<a name="line-5"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Div</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>DivP</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n'</span><span class='hs-layout'>)</span>
<a name="line-6"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Div</span> <span class='hs-layout'>(</span><span class='hs-conid'>N</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>N</span> <span class='hs-varid'>n'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>DivP</span> <span class='hs-varid'>n</span> <span class='hs-varid'>n'</span>
<a name="line-7"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Div</span> <span class='hs-layout'>(</span><span class='hs-conid'>N</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span> <span class='hs-layout'>(</span><span class='hs-conid'>DivP</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n'</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-8"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-keyword'>instance</span> <span class='hs-conid'>Div</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>N</span> <span class='hs-varid'>n'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span> <span class='hs-layout'>(</span><span class='hs-conid'>DivP</span> <span class='hs-layout'>(</span><span class='hs-conid'>S</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-varid'>n'</span><span class='hs-layout'>)</span>
</pre>

= Value level functions =

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>{- $functions
<a name="line-2"></a>&gt; Using the above type families we define functions for various
<a name="line-3"></a>&gt; arithmetic operations. All functions are undefined and only operate
<a name="line-4"></a>&gt; on the type level. Their main contribution is that they facilitate
<a name="line-5"></a>&gt; NumType arithmetic without explicit (and tedious) type declarations.
<a name="line-6"></a>&gt; -}</span>
</pre>
The main reason to collect all functions here is to keep the
preceeding sections free from distraction.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Negate a 'NumType'.</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>negate</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NumType</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Negate</span> <span class='hs-varid'>a</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>negate</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
</pre>
<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Increment a 'NumType' by one.</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>incr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NumType</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Succ</span> <span class='hs-varid'>a</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>incr</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
</pre>
<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Decrement a 'NumType' by one.</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>decr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>NumType</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Pred</span> <span class='hs-varid'>a</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>decr</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
</pre>
<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Add two 'NumType's.</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-layout'>(</span><span class='hs-varop'>+</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>NumType</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>NumType</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Add</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>_</span> <span class='hs-varop'>+</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
</pre>
<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Subtract the second 'NumType' from the first.</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-layout'>(</span><span class='hs-comment'>-</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>NumType</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>NumType</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Sub</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>_</span> <span class='hs-comment'>-</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
</pre>
<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Multiply two 'NumType's.</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-layout'>(</span><span class='hs-varop'>*</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>NumType</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>NumType</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Mul</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>_</span> <span class='hs-varop'>*</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
</pre>
<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-comment'>-- | Divide the first 'NumType' by the second.</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-layout'>(</span><span class='hs-varop'>/</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>NumType</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>NumType</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Div</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>_</span> <span class='hs-varop'>/</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
</pre>

= Convenince types and values =

Finally we define some type synonyms for the convenience of clients
of the library.

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Zero</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Z</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Pos1</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span> <span class='hs-conid'>Z</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Pos2</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span> <span class='hs-conid'>Pos1</span>
<a name="line-4"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Pos3</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span> <span class='hs-conid'>Pos2</span>
<a name="line-5"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Pos4</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span> <span class='hs-conid'>Pos3</span>
<a name="line-6"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Pos5</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span> <span class='hs-conid'>Pos4</span>
<a name="line-7"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Neg1</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span> <span class='hs-conid'>Pos1</span>
<a name="line-8"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Neg2</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span> <span class='hs-conid'>Pos2</span>
<a name="line-9"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Neg3</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span> <span class='hs-conid'>Pos3</span>
<a name="line-10"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Neg4</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span> <span class='hs-conid'>Pos4</span>
<a name="line-11"></a><span class='hs-varop'>&gt;</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Neg5</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span> <span class='hs-conid'>Pos5</span>
</pre>
Analogously we also define some convenience values (all 'undefined'
but with the expected types).

<pre><a name="line-1"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>zero</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Z</span>  <span class='hs-comment'>-- ~ hZero</span>
<a name="line-2"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>zero</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
<a name="line-3"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>pos1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pos1</span>
<a name="line-4"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>pos1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>incr</span> <span class='hs-varid'>zero</span>
<a name="line-5"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>pos2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pos2</span>
<a name="line-6"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>pos2</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>incr</span> <span class='hs-varid'>pos1</span>
<a name="line-7"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>pos3</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pos3</span>
<a name="line-8"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>pos3</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>incr</span> <span class='hs-varid'>pos2</span>
<a name="line-9"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>pos4</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pos4</span>
<a name="line-10"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>pos4</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>incr</span> <span class='hs-varid'>pos3</span>
<a name="line-11"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>pos5</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pos5</span>
<a name="line-12"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>pos5</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>incr</span> <span class='hs-varid'>pos4</span>
<a name="line-13"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>neg1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Neg1</span>
<a name="line-14"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>neg1</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>decr</span> <span class='hs-varid'>zero</span>
<a name="line-15"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>neg2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Neg2</span>
<a name="line-16"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>neg2</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>decr</span> <span class='hs-varid'>neg1</span>
<a name="line-17"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>neg3</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Neg3</span>
<a name="line-18"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>neg3</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>decr</span> <span class='hs-varid'>neg2</span>
<a name="line-19"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>neg4</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Neg4</span>
<a name="line-20"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>neg4</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>decr</span> <span class='hs-varid'>neg3</span>
<a name="line-21"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>neg5</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Neg5</span>
<a name="line-22"></a><span class='hs-varop'>&gt;</span> <span class='hs-definition'>neg5</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>decr</span> <span class='hs-varid'>neg4</span>
</pre>

= References =

[1] http://homepages.cwi.nl/~ralf/HList/
[2] http://okmij.org/ftp/Computation/resource-aware-prog/BinaryNumber.hs
</body>
</html>
