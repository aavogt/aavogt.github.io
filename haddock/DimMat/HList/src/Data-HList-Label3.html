<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Data/HList/Label3.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a>
<a name="line-2"></a><span class='hs-comment'>{- |
<a name="line-3"></a>
<a name="line-4"></a>   Description : namespaced labels
<a name="line-5"></a>
<a name="line-6"></a>   The HList library
<a name="line-7"></a>
<a name="line-8"></a>   (C) 2004-2006, Oleg Kiselyov, Ralf Laemmel, Keean Schupke
<a name="line-9"></a>
<a name="line-10"></a>   A model of labels as needed for extensible records. As before,
<a name="line-11"></a>   all the information about labels is recorded in their type, so
<a name="line-12"></a>   the labels of records may be purely phantom. In general,
<a name="line-13"></a>   Labels are exclusively type-level entities and have no run-time
<a name="line-14"></a>   representation.
<a name="line-15"></a>
<a name="line-16"></a>   Record labels are triplets of type-level naturals, namespace,
<a name="line-17"></a>   and description. The namespace part helps avoid confusions between
<a name="line-18"></a>   labels from different Haskell modules. The description is
<a name="line-19"></a>   an arbitrary nullary type constructor.
<a name="line-20"></a>
<a name="line-21"></a>   For the sake of printing, the description is required to be the
<a name="line-22"></a>   instance of Show. One must make sure that the show functions does
<a name="line-23"></a>   not examine the value, as descr is purely phantom. Here's an
<a name="line-24"></a>   example of the good Label description:
<a name="line-25"></a>
<a name="line-26"></a>   &gt;     data MyLabelDescr; instance Show MyLabelDescr where show _ = "descr"
<a name="line-27"></a>
<a name="line-28"></a>   which are automated by makeLabels3 from "Data.HList.MakeLabel".
<a name="line-29"></a>
<a name="line-30"></a>   This model even allows the labels in a record to belong to different
<a name="line-31"></a>   namespaces. To this end, the model employs the predicate for type
<a name="line-32"></a>   equality.
<a name="line-33"></a>-}</span>
<a name="line-34"></a>
<a name="line-35"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>HList</span><span class='hs-varop'>.</span><span class='hs-conid'>Label3</span> <span class='hs-keyword'>where</span>
<a name="line-36"></a>
<a name="line-37"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>HList</span><span class='hs-varop'>.</span><span class='hs-conid'>FakePrelude</span>
<a name="line-38"></a>
<a name="line-39"></a>
<a name="line-40"></a><a name="Lbl"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>Lbl</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HNat</span><span class='hs-layout'>)</span> <span class='hs-varid'>ns</span> <span class='hs-varid'>desc</span>  <span class='hs-comment'>-- labels are exclusively type-level entities</span>
<a name="line-41"></a>
<a name="line-42"></a>
<a name="line-43"></a><span class='hs-comment'>-- Public constructors for labels</span>
<a name="line-44"></a>
<a name="line-45"></a><a name="firstLabel"></a><span class='hs-comment'>-- | Construct the first label</span>
<a name="line-46"></a><span class='hs-definition'>firstLabel</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>ns</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>desc</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Label</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lbl</span> <span class='hs-conid'>HZero</span> <span class='hs-varid'>ns</span> <span class='hs-varid'>desc</span><span class='hs-layout'>)</span>
<a name="line-47"></a><span class='hs-definition'>firstLabel</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
<a name="line-48"></a>
<a name="line-49"></a>
<a name="line-50"></a><a name="nextLabel"></a><span class='hs-comment'>-- | Construct the next label</span>
<a name="line-51"></a><span class='hs-definition'>nextLabel</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Label</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lbl</span> <span class='hs-varid'>x</span> <span class='hs-varid'>ns</span> <span class='hs-varid'>desc</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>desc'</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Label</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lbl</span> <span class='hs-layout'>(</span><span class='hs-conid'>HSucc</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-varid'>ns</span> <span class='hs-varid'>desc'</span><span class='hs-layout'>)</span>
<a name="line-52"></a><span class='hs-definition'>nextLabel</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
<a name="line-53"></a>
<a name="line-54"></a>
<a name="line-55"></a><span class='hs-comment'>-- | Equality on labels (descriptions are ignored)</span>
<a name="line-56"></a><span class='hs-comment'>-- Use generic instance</span>
<a name="line-57"></a><span class='hs-comment'>{-
<a name="line-58"></a>instance ( HEq x x' b
<a name="line-59"></a>         , HEq ns ns' b'
<a name="line-60"></a>	 , bres ~ HAnd b b'
<a name="line-61"></a>         )
<a name="line-62"></a>      =&gt;   HEq (Lbl x ns desc) (Lbl x' ns' desc') bres
<a name="line-63"></a>-}</span>
<a name="line-64"></a>
<a name="line-65"></a><span class='hs-comment'>-- | Show label</span>
<a name="line-66"></a>
<a name="line-67"></a><a name="instance%20ShowLabel%20(Lbl%20x%20ns%20desc)"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Show</span> <span class='hs-varid'>desc</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>ShowLabel</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lbl</span> <span class='hs-varid'>x</span> <span class='hs-varid'>ns</span> <span class='hs-varid'>desc</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-68"></a>  <span class='hs-varid'>showLabel</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>show</span> <span class='hs-varop'>.</span> <span class='hs-varid'>getd</span>
<a name="line-69"></a>      <span class='hs-keyword'>where</span> <span class='hs-varid'>getd</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Label</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lbl</span> <span class='hs-varid'>x</span> <span class='hs-varid'>ns</span> <span class='hs-varid'>desc</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>desc</span> <span class='hs-comment'>-- for the sake of Hugs</span>
<a name="line-70"></a>            <span class='hs-varid'>getd</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
<a name="line-71"></a>
<a name="line-72"></a><a name="instance%20Show%20(Label%20(Lbl%20x%20ns%20desc))"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>Show</span> <span class='hs-varid'>desc</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Show</span> <span class='hs-layout'>(</span><span class='hs-conid'>Label</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lbl</span> <span class='hs-varid'>x</span> <span class='hs-varid'>ns</span> <span class='hs-varid'>desc</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-73"></a> <span class='hs-keyword'>where</span>
<a name="line-74"></a>  <span class='hs-varid'>show</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>show</span> <span class='hs-varop'>.</span> <span class='hs-varid'>getd</span>
<a name="line-75"></a>      <span class='hs-keyword'>where</span> <span class='hs-varid'>getd</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Label</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lbl</span> <span class='hs-varid'>x</span> <span class='hs-varid'>ns</span> <span class='hs-varid'>desc</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>desc</span> <span class='hs-comment'>-- for the sake of Hugs</span>
<a name="line-76"></a>            <span class='hs-varid'>getd</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>undefined</span>
<a name="line-77"></a>
</pre></body>
</html>
